# Honey Agent Tools

ä¸€ä¸ªåŸºäº Tauri + React + TypeScript çš„ç±» uTools æ¡Œé¢åº”ç”¨ï¼Œæä¾›å¿«æ·çš„æ’ä»¶ç³»ç»Ÿã€å…¨å±€å¿«æ·é”®å’Œç‹¬ç«‹çª—å£ç®¡ç†ã€‚

> âš ï¸ **é‡è¦æŠ€æœ¯æ ˆè¯´æ˜**
>
> - æœ¬é¡¹ç›®ä½¿ç”¨ **Tailwind CSS 4**ï¼ˆä¸æ˜¯ v3ï¼‰- é…ç½®åœ¨ `index.css` çš„ `@theme` ä¸­ï¼Œ**ä¸è¦åˆ›å»º `tailwind.config.js`**ï¼
> - ä½¿ç”¨ **shadcn/ui** ç»„ä»¶åº“ï¼ˆéœ€é€‚é… Tailwind 4ï¼‰
> - ä½¿ç”¨ **Tauri 2.x**ï¼ˆéœ€é…ç½® capabilities æƒé™ï¼‰

## æŠ€æœ¯æ ˆ

| æŠ€æœ¯                               | ç‰ˆæœ¬       | ç”¨é€”             | ç‰¹åˆ«è¯´æ˜                      |
| ---------------------------------- | ---------- | ---------------- | ----------------------------- |
| React                              | 19.1.0     | å‰ç«¯æ¡†æ¶         |                               |
| TypeScript                         | 5.8.3      | ç±»å‹ç³»ç»Ÿ         |                               |
| Tauri                              | 2.0.0      | æ¡Œé¢åº”ç”¨æ¡†æ¶     | éœ€é…ç½® capabilities           |
| Zustand                            | 5.0.9      | çŠ¶æ€ç®¡ç†         |                               |
| **Tailwind CSS**                   | **4.1.18** | **CSS æ¡†æ¶**     | **ä½¿ç”¨ @themeï¼Œé config.js** |
| shadcn/ui                          | latest     | UI ç»„ä»¶åº“        | éœ€é€‚é… Tailwind 4             |
| Biome                              | 2.3.8      | ä»£ç è§„èŒƒå’Œæ ¼å¼åŒ– |                               |
| @tauri-apps/plugin-global-shortcut | 2.3.1      | å…¨å±€å¿«æ·é”®æ”¯æŒ   |                               |

## é¡¹ç›®ç»“æ„

```
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ components/              # UI ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ ui/                  # shadcn/ui ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ command.tsx      # Command ç»„ä»¶ï¼ˆæ’ä»¶æœç´¢ï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ card.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ button.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ badge.tsx
â”‚   â”‚   â”‚   â””â”€â”€ ...
â”‚   â”‚   â”œâ”€â”€ Settings.tsx         # è®¾ç½®é¡µé¢
â”‚   â”‚   â””â”€â”€ PluginWindow.tsx     # æ’ä»¶ç»“æœçª—å£ï¼ˆå·²åºŸå¼ƒï¼Œç”¨ç‹¬ç«‹çª—å£ï¼‰
â”‚   â”œâ”€â”€ plugins/                 # æ’ä»¶ç³»ç»Ÿ
â”‚   â”‚   â”œâ”€â”€ types.ts             # æ’ä»¶ç±»å‹å®šä¹‰
â”‚   â”‚   â”œâ”€â”€ registry.ts          # æ’ä»¶æ³¨å†Œè¡¨
â”‚   â”‚   â”œâ”€â”€ matcher.ts           # æ’ä»¶åŒ¹é…å¼•æ“
â”‚   â”‚   â””â”€â”€ builtin/             # å†…ç½®æ’ä»¶
â”‚   â”‚       â”œâ”€â”€ calculator/      # è®¡ç®—å™¨æ’ä»¶
â”‚   â”‚       â””â”€â”€ translate/       # ç¿»è¯‘æ’ä»¶
â”‚   â”œâ”€â”€ hooks/
â”‚   â”‚   â”œâ”€â”€ useShortcut.ts       # å¿«æ·é”®ç›‘å¬
â”‚   â”‚   â””â”€â”€ usePluginMatcher.ts  # æ’ä»¶åŒ¹é… Hook
â”‚   â”œâ”€â”€ store/
â”‚   â”‚   â”œâ”€â”€ appStore.ts          # åº”ç”¨çŠ¶æ€
â”‚   â”‚   â”œâ”€â”€ shortcutStore.ts     # å¿«æ·é”®é…ç½®
â”‚   â”‚   â”œâ”€â”€ pluginStore.ts       # æ’ä»¶çŠ¶æ€
â”‚   â”‚   â””â”€â”€ searchStore.ts       # æœç´¢çŠ¶æ€
â”‚   â”œâ”€â”€ lib/
â”‚   â”‚   â””â”€â”€ utils.ts             # shadcn å·¥å…·å‡½æ•° (cn)
â”‚   â”œâ”€â”€ App.tsx                  # ä¸»çª—å£åº”ç”¨
â”‚   â”œâ”€â”€ PluginWindow.tsx         # æ’ä»¶çª—å£ç»„ä»¶
â”‚   â”œâ”€â”€ plugin-main.tsx          # æ’ä»¶çª—å£å…¥å£
â”‚   â”œâ”€â”€ index.css                # å…¨å±€æ ·å¼ï¼ˆTailwind 4 + shadcnï¼‰
â”‚   â””â”€â”€ main.tsx                 # ä¸»çª—å£å…¥å£
â”œâ”€â”€ src-tauri/
â”‚   â”œâ”€â”€ capabilities/            # Tauri æƒé™é…ç½®
â”‚   â”‚   â””â”€â”€ plugin-window.json   # æ’ä»¶çª—å£æƒé™
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ lib.rs               # çª—å£ç®¡ç†å‘½ä»¤
â”‚   â”‚   â””â”€â”€ main.rs
â”‚   â””â”€â”€ tauri.conf.json
â”œâ”€â”€ plugin-result.html           # æ’ä»¶çª—å£ HTML
â”œâ”€â”€ index.html                   # ä¸»çª—å£ HTML
â”œâ”€â”€ vite.config.ts               # Vite å¤šé¡µé¢é…ç½®
â””â”€â”€ components.json              # shadcn é…ç½®
```

## æ ¸å¿ƒåŠŸèƒ½

### 1. æ’ä»¶ç³»ç»Ÿ ğŸ”Œ

#### è®¾è®¡æ€è·¯

ç±»ä¼¼ uTools çš„æ’ä»¶æ¶æ„ï¼š

- ç”¨æˆ·è¾“å…¥ â†’ æ™ºèƒ½åŒ¹é…æ’ä»¶ â†’ æ‰§è¡Œæ’ä»¶ â†’ ç‹¬ç«‹çª—å£æ˜¾ç¤ºç»“æœ
- æ”¯æŒå…³é”®è¯ã€æ­£åˆ™ã€æ¨¡ç³Šä¸‰ç§åŒ¹é…æ–¹å¼
- æ’ä»¶ç‹¬ç«‹çª—å£æ˜¾ç¤ºç»“æœï¼ˆä¸æ˜¯ React modalï¼‰

#### æ’ä»¶ç±»å‹å®šä¹‰ (`plugins/types.ts`)

```typescript
interface Plugin {
  id: string;
  name: string;
  description: string;
  icon?: ReactNode;
  config: PluginConfig;
  execute: (context: PluginContext) => void | Promise<void>;
  getPreview?: (input: string) => ReactNode;
}

interface PluginConfig {
  keywords?: string[]; // å…³é”®è¯åŒ¹é…
  pattern?: RegExp; // æ­£åˆ™åŒ¹é…
  fuzzy?: boolean; // æ¨¡ç³Šæœç´¢
  priority?: number; // ä¼˜å…ˆçº§
  featured?: boolean; // ç²¾é€‰æ ‡è®°
  enabled?: boolean;
}
```

#### æ’ä»¶æ³¨å†Œè¡¨ (`plugins/registry.ts`)

å•ä¾‹æ¨¡å¼ç®¡ç†æ‰€æœ‰æ’ä»¶ï¼š

```typescript
class PluginRegistry {
  register(plugin: Plugin): void;
  unregister(pluginId: string): void;
  getAllPlugins(): Plugin[];
  getPlugin(id: string): Plugin | undefined;
}

export const pluginRegistry = new PluginRegistry();
```

#### æ’ä»¶åŒ¹é…å¼•æ“ (`plugins/matcher.ts`)

æ™ºèƒ½åŒ¹é…ç®—æ³•ï¼š

1. **å…³é”®è¯åŒ¹é…**ï¼šç²¾ç¡®åŒ¹é…ï¼Œåˆ†æ•° 100
2. **æ­£åˆ™åŒ¹é…**ï¼šæ¨¡å¼åŒ¹é…ï¼Œåˆ†æ•° 90
3. **æ¨¡ç³Šæœç´¢**ï¼šFuzzy ç®—æ³•ï¼Œåˆ†æ•° 0-80

```typescript
class PluginMatcher {
  match(query: string, plugins: Plugin[]): MatchResult[];
}
```

#### å†…ç½®æ’ä»¶ç¤ºä¾‹

**è®¡ç®—å™¨æ’ä»¶** (`plugins/builtin/calculator`):

- åŒ¹é…ï¼šæ•°å­¦è¡¨è¾¾å¼ï¼ˆ`/^[\d+\-*/().\s]+$/`ï¼‰
- æ‰§è¡Œï¼šè®¡ç®—ç»“æœå¹¶æ˜¾ç¤º

**ç¿»è¯‘æ’ä»¶** (`plugins/builtin/translate`):

- å…³é”®è¯ï¼š`['ç¿»è¯‘', 'translate', 'fy']`
- æ‰§è¡Œï¼šè°ƒç”¨ç¿»è¯‘ API

### 2. ç‹¬ç«‹çª—å£ç³»ç»Ÿ ğŸªŸ

#### è®¾è®¡æ¶æ„

```
ä¸»çª—å£ (main)              æ’ä»¶çª—å£ (plugin-window)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æœç´¢æ¡†      â”‚            â”‚ æ’ä»¶ç»“æœå±•ç¤º     â”‚
â”‚ æ’ä»¶åˆ—è¡¨    â”‚ â”€â”€â”€â”€â”€â”€â”€â”€> â”‚ + æ“ä½œæŒ‰é’®       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â†‘                            â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€å…³é—­åé‡æ–°èšç„¦â”€â”€â”€â”€â”€â”€â”˜
```

#### Rust çª—å£å‘½ä»¤ (`lib.rs`)

```rust
#[tauri::command]
async fn create_plugin_window(
    app: tauri::AppHandle,
    data: PluginData,  // æ’ä»¶IDã€åç§°ã€è¾“å…¥ã€ç»“æœ
) -> Result<(), String>

#[tauri::command]
async fn close_plugin_window(app: tauri::AppHandle) -> Result<(), String>
```

**å…³é”®å®ç°**ï¼š

- âœ… å»¶è¿Ÿ 300ms å‘é€æ•°æ®ï¼ˆç­‰å¾…çª—å£åŠ è½½ï¼‰
- âœ… ä¸»çª—å£ä¸éšè—ï¼Œåªå¤±å»ç„¦ç‚¹ï¼ˆé¿å…ç©ºç™½é—®é¢˜ï¼‰
- âœ… ä½¿ç”¨ Tauri Events é€šä¿¡

#### Tauri Capabilities é…ç½®

**ä¸ºä»€ä¹ˆéœ€è¦**ï¼šTauri 2 é»˜è®¤åªå…è®¸ `main` çª—å£ç›‘å¬äº‹ä»¶

**è§£å†³æ–¹æ¡ˆ**ï¼šåˆ›å»º `src-tauri/capabilities/plugin-window.json`

```json
{
  "identifier": "plugin-window",
  "windows": ["plugin-window"],
  "permissions": ["core:event:allow-listen", "core:event:allow-emit"]
}
```

#### Vite å¤šé¡µé¢é…ç½®

```typescript
// vite.config.ts
build: {
  rollupOptions: {
    input: {
      main: path.resolve(__dirname, 'index.html'),
      plugin: path.resolve(__dirname, 'plugin-result.html'),
    },
  },
}
```

### 3. shadcn/ui é›†æˆ ğŸ¨

#### ä¸ºä»€ä¹ˆç”¨ shadcnï¼Ÿ

- âœ… ç»„ä»¶åŒ–ã€å¯ç»´æŠ¤
- âœ… å®Œç¾çš„é”®ç›˜å¯¼èˆªæ”¯æŒ
- âœ… å†…ç½®æ— éšœç¢åŠŸèƒ½
- âœ… Command ç»„ä»¶éå¸¸é€‚åˆæ’ä»¶æœç´¢

#### å·²å®‰è£…ç»„ä»¶

- `Command` - æ’ä»¶æœç´¢ç•Œé¢ï¼ˆæ ¸å¿ƒï¼‰
- `Card`, `Button`, `Badge`, `Separator` - è®¾ç½®å’Œç»“æœå±•ç¤º
- `Dialog` - å¯¹è¯æ¡†

#### Tailwind 4 + shadcn é€‚é…

**å…³é”®ç‚¹**ï¼šshadcn é»˜è®¤ç”¨ Tailwind 3ï¼Œéœ€è¦é€‚é… Tailwind 4

**index.css é…ç½®**ï¼š

```css
@import "tailwindcss";

/* shadcn CSS å˜é‡ */
@theme {
  --color-background: 0 0% 100%;
  --color-foreground: 222.2 84% 4.9%;
  --color-primary: 221.2 83.2% 53.3%;
  /* ... æ›´å¤š shadcn é¢œè‰² ... */

  --radius-lg: 0.5rem;
  --animate-accordion-down: accordion-down 0.2s ease-out;
}
```

> âš ï¸ **é‡è¦**ï¼šä¸è¦åˆ›å»º `tailwind.config.js`ï¼Tailwind 4 æ‰€æœ‰é…ç½®éƒ½åœ¨ CSS çš„ `@theme` ä¸­ã€‚

**PostCSS é…ç½®**ï¼š

```javascript
export default {
  plugins: {
    "@tailwindcss/postcss": {},
    autoprefixer: {},
  },
};
```

### 4. å¿«æ·é”®ç³»ç»Ÿ âŒ¨ï¸

ï¼ˆä¿ç•™åŸæœ‰å†…å®¹ï¼Œç•¥ï¼‰

### 5. çŠ¶æ€ç®¡ç† ğŸ“¦

#### pluginStore (Zustand)

```typescript
{
  activePlugin: Plugin | null        // å½“å‰æ¿€æ´»çš„æ’ä»¶
  matchedPlugins: MatchResult[]      // åŒ¹é…çš„æ’ä»¶åˆ—è¡¨
  pluginMetadata: Record<string, {   // æ’ä»¶å…ƒæ•°æ®
    usageCount: number
    lastUsed: number
  }>
}
```

#### searchStore (Zustand)

```typescript
{
  query: string; // æœç´¢å…³é”®è¯
  selectedIndex: number; // é€‰ä¸­çš„æ’ä»¶ç´¢å¼•
  extractedInput: string; // æå–çš„è¾“å…¥
  showPluginList: boolean; // æ˜¯å¦æ˜¾ç¤ºåˆ—è¡¨
}
```

## å·¥ä½œæµç¨‹ç¤ºä¾‹

### ç”¨æˆ·ä½¿ç”¨è®¡ç®—å™¨æ’ä»¶

```
1. æŒ‰ Cmd+Shift+Space å‘¼å‡ºä¸»çª—å£
2. è¾“å…¥ "2+3"
   â†“
3. usePluginMatcher ç›‘å¬queryå˜åŒ–
   â†“
4. PluginMatcher åŒ¹é…åˆ°è®¡ç®—å™¨æ’ä»¶ï¼ˆæ­£åˆ™åŒ¹é…ï¼‰
   â†“
5. Command ç»„ä»¶æ˜¾ç¤ºåŒ¹é…ç»“æœ
   â†“
6. ç”¨æˆ·æŒ‰ Enter æˆ–ç‚¹å‡»
   â†“
7. executePlugin() è°ƒç”¨ Tauri å‘½ä»¤ create_plugin_window
   â†“
8. Rust åˆ›å»ºæ’ä»¶çª—å£ï¼Œå»¶è¿Ÿ300mså‘é€æ•°æ®
   â†“
9. PluginWindow.tsx ç›‘å¬ "plugin-data" äº‹ä»¶
   â†“
10. æ˜¾ç¤ºç»“æœ "2+3 = 5"
   â†“
11. ç”¨æˆ·ç‚¹å‡»å…³é—­ï¼Œè°ƒç”¨ close_plugin_window
   â†“
12. ä¸»çª—å£é‡æ–°èšç„¦
```

## å¸¸è§é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ â“

### æ’ä»¶ç›¸å…³

**Q: æ’ä»¶çª—å£ä¸€ç›´æ˜¾ç¤º Loadingï¼Ÿ**

A: æƒé™é—®é¢˜ã€‚éœ€è¦åˆ›å»º `capabilities/plugin-window.json` æˆäºˆäº‹ä»¶ç›‘å¬æƒé™ã€‚

**Q: æ’ä»¶æ•°æ®æ²¡æœ‰ä¼ åˆ°çª—å£ï¼Ÿ**

A: æ—¶åºé—®é¢˜ã€‚Rust éœ€è¦å»¶è¿Ÿå‘é€æ•°æ®ï¼š

```rust
std::thread::spawn(move || {
    std::thread::sleep(Duration::from_millis(300));
    window_clone.emit("plugin-data", &data_clone)
});
```

**Q: ä¸»çª—å£å†æ¬¡å‘¼å‡ºæ—¶å˜ç©ºç™½ï¼Ÿ**

A: ä¸è¦éšè—ä¸»çª—å£ï¼Œåªè®©å®ƒå¤±å»ç„¦ç‚¹ã€‚

### shadcn/ui ç›¸å…³

**Q: ä¸ºä»€ä¹ˆä¸èƒ½åˆ›å»º tailwind.config.jsï¼Ÿ**

A: é¡¹ç›®ä½¿ç”¨ Tailwind 4ï¼Œé…ç½®åœ¨ `index.css` çš„ `@theme` ä¸­ã€‚å¦‚æœåˆ›å»ºäº† config æ–‡ä»¶ä¼šå¯¼è‡´é…ç½®å†²çªã€‚

**Q: Command ç»„ä»¶ä¸æ˜¾ç¤ºåŒ¹é…ç»“æœï¼Ÿ**

A: éœ€è¦æ·»åŠ  `shouldFilter={false}`ï¼Œå¦åˆ™ cmdk ä¼šè‡ªå·±è¿‡æ»¤ï¼š

```tsx
<Command shouldFilter={false}>
```

### Tauri ç›¸å…³

**Q: event.listen not allowed on window "plugin-window"ï¼Ÿ**

A: éœ€è¦åœ¨ `capabilities/` ç›®å½•åˆ›å»ºæƒé™é…ç½®æ–‡ä»¶ã€‚

## å¼€å‘æœ€ä½³å®è·µ ğŸ’¡

### 1. æ·»åŠ æ–°æ’ä»¶

```typescript
// 1. åˆ›å»ºæ’ä»¶æ–‡ä»¶
// src/plugins/builtin/my-plugin/index.tsx

export const myPlugin: Plugin = {
  id: "my-plugin",
  name: "æˆ‘çš„æ’ä»¶",
  description: "æ’ä»¶æè¿°",
  config: {
    keywords: ["å…³é”®è¯"],
    priority: 90,
  },
  execute: (context) => {
    // æ’ä»¶é€»è¾‘
    context.showNotification("ç»“æœ");
  },
};

// 2. æ³¨å†Œæ’ä»¶
// src/App.tsx
pluginRegistry.register(myPlugin);
```

### 2. ä½¿ç”¨ logger è€Œä¸æ˜¯ console

```typescript
// âŒ ä¸æ¨è
console.log("debug info");

// âœ… æ¨è
logger.log("debug info"); // åªåœ¨å¼€å‘ç¯å¢ƒæ˜¾ç¤º
```

### 3. ç¡®ä¿ Tailwind 4 é…ç½®æ­£ç¡®

**ä¸è¦åˆ›å»º**ï¼š

- âŒ `tailwind.config.js`
- âŒ `tailwind.config.ts`

**åªé…ç½®**ï¼š

- âœ… `index.css` ä¸­çš„ `@theme`
- âœ… `postcss.config.js`

## æŠ€æœ¯å€ºåŠ¡å’Œæ”¹è¿›

### å·²å®Œæˆ âœ…

- âœ… æ’ä»¶ç³»ç»ŸåŸºç¡€æ¶æ„
- âœ… æ’ä»¶ç‹¬ç«‹çª—å£
- âœ… shadcn/ui é›†æˆ
- âœ… æ™ºèƒ½æ’ä»¶åŒ¹é…
- âœ… å¿«æ·é”®ç³»ç»Ÿ
- âœ… åŠ¨æ€çª—å£é«˜åº¦

### å¾…æ”¹è¿› ğŸ¯

- [ ] æ’ä»¶é…ç½®ç•Œé¢
- [ ] æ’ä»¶å¸‚åœº
- [ ] æ›´å¤šå†…ç½®æ’ä»¶
- [ ] æ’ä»¶å¼€å‘æ–‡æ¡£
- [ ] å•å…ƒæµ‹è¯•

## è®¸å¯è¯

MIT

---

> ğŸ’¡ **ç»™ AI Agent çš„æç¤º**ï¼š
>
> - æœ¬é¡¹ç›®ä½¿ç”¨ **Tailwind 4**ï¼Œä¸è¦åˆ›å»º config æ–‡ä»¶ï¼
> - shadcn ç»„ä»¶éœ€è¦é€‚é… Tailwind 4 çš„ `@theme` è¯­æ³•
> - Tauri 2 éœ€è¦é…ç½® capabilities æƒé™
> - æ’ä»¶çª—å£éœ€è¦å»¶è¿Ÿå‘é€æ•°æ®ï¼ˆ300msï¼‰
